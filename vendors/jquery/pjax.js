(function(t){function e(e,a,n){var i=this;return this.on("click.pjax",e,function(e){var o=t.extend({},g(a,n));if(!o.container)o.container=t(this).attr("data-pjax")||i;r(e,o)})}function r(e,r,a){a=g(r,a);var i=e.currentTarget;if(i.tagName.toUpperCase()!=="A")throw"$.fn.pjax or $.pjax.click requires an anchor element";if(e.which>1||e.metaKey||e.ctrlKey||e.shiftKey||e.altKey)return;if(location.protocol!==i.protocol||location.hostname!==i.hostname)return;if(i.href.indexOf("#")>-1&&x(i)==x(location))return;if(e.isDefaultPrevented())return;var o={url:i.href,container:t(i).attr("data-pjax"),target:i};var s=t.extend({},o,a);var c=t.Event("pjax:click");t(i).trigger(c,[s]);if(!c.isDefaultPrevented()){n(s);e.preventDefault();t(i).trigger("pjax:clicked",[s])}}function a(e,r,a){a=g(r,a);var i=e.currentTarget;var o=t(i);if(i.tagName.toUpperCase()!=="FORM")throw"$.pjax.submit requires a form element";var s={type:(o.attr("method")||"GET").toUpperCase(),url:o.attr("action"),container:o.attr("data-pjax"),target:i};if(s.type!=="GET"&&window.FormData!==undefined){s.data=new FormData(i);s.processData=false;s.contentType=false}else{if(t(i).find(":file").length){return}s.data=t(i).serializeArray()}n(t.extend({},s,a));e.preventDefault()}function n(e){e=t.extend(true,{},t.ajaxSettings,n.defaults,e);if(t.isFunction(e.url)){e.url=e.url()}var r=e.target;var a=m(e.url).hash;var i=e.context=j(e.container);if(!e.data)e.data={};if(t.isArray(e.data)){e.data.push({name:"_pjax",value:i.selector})}else{e.data._pjax=i.selector}function s(e,a,n){if(!n)n={};n.relatedTarget=r;var o=t.Event(e,n);i.trigger(o,a);return!o.isDefaultPrevented()}var c;e.beforeSend=function(t,r){if(r.type!=="GET"){r.timeout=0}t.setRequestHeader("X-PJAX","true");t.setRequestHeader("X-PJAX-Container",i.selector);if(!s("pjax:beforeSend",[t,r]))return false;if(r.timeout>0){c=setTimeout(function(){if(s("pjax:timeout",[t,e]))t.abort("timeout")},r.timeout);r.timeout=0}var n=m(r.url);if(a)n.hash=a;e.requestUrl=v(n)};e.complete=function(t,r){if(c)clearTimeout(c);s("pjax:complete",[t,r,e]);s("pjax:end",[t,e])};e.error=function(t,r,a){var n=b("",t,e);var i=s("pjax:error",[t,r,a,e]);if(e.type=="GET"&&r!=="abort"&&i){o(n.url)}};e.success=function(r,c,u){var l=n.state;var f=typeof t.pjax.defaults.version==="function"?t.pjax.defaults.version():t.pjax.defaults.version;var p=u.getResponseHeader("X-PJAX-Version");var h=b(r,u,e);var v=m(h.url);if(a){v.hash=a;h.url=v.href}if(f&&p&&f!==p){o(h.url);return}if(!h.contents){o(h.url);return}n.state={id:e.id||d(),url:h.url,title:h.title,container:i.selector,fragment:e.fragment,timeout:e.timeout};if(e.push||e.replace){window.history.replaceState(n.state,h.title,h.url)}var x=t.contains(e.container,document.activeElement);if(x){try{document.activeElement.blur()}catch(g){}}if(h.title)document.title=h.title;s("pjax:beforeReplace",[h.contents,e],{state:n.state,previousState:l});i.html(h.contents);var j=i.find("input[autofocus], textarea[autofocus]").last()[0];if(j&&document.activeElement!==j){j.focus()}T(h.scripts);var y=e.scrollTo;if(a){var w=decodeURIComponent(a.slice(1));var E=document.getElementById(w)||document.getElementsByName(w)[0];if(E)y=t(E).offset().top}if(typeof y=="number")t(window).scrollTop(y);s("pjax:success",[r,c,u,e])};if(!n.state){n.state={id:d(),url:window.location.href,title:document.title,container:i.selector,fragment:e.fragment,timeout:e.timeout};window.history.replaceState(n.state,document.title)}p(n.xhr);n.options=e;var u=n.xhr=t.ajax(e);if(u.readyState>0){if(e.push&&!e.replace){C(n.state.id,h(i));window.history.pushState(null,"",e.requestUrl)}s("pjax:start",[u,e]);s("pjax:send",[u,e])}return n.xhr}function i(e,r){var a={url:window.location.href,push:false,replace:true,scrollTo:false};return n(t.extend(a,g(e,r)))}function o(t){window.history.replaceState(null,"",n.state.url);window.location.replace(t)}var s=true;var c=window.location.href;var u=window.history.state;if(u&&u.container){n.state=u}if("state"in window.history){s=false}function l(e){if(!s){p(n.xhr)}var r=n.state;var a=e.state;var i;if(a&&a.container){if(s&&c==a.url)return;if(r){if(r.id===a.id)return;i=r.id<a.id?"forward":"back"}var u=E[a.id]||[];var l=t(u[0]||a.container),f=u[1];if(l.length){if(r){A(i,r.id,h(l))}var d=t.Event("pjax:popstate",{state:a,direction:i});l.trigger(d);var v={id:a.id,url:a.url,container:l,push:false,fragment:a.fragment,timeout:a.timeout,scrollTo:false};if(f){l.trigger("pjax:start",[null,v]);n.state=a;if(a.title)document.title=a.title;var m=t.Event("pjax:beforeReplace",{state:a,previousState:r});l.trigger(m,[f,v]);l.html(f);l.trigger("pjax:end",[null,v])}else{n(v)}l[0].offsetHeight}else{o(location.href)}}s=false}function f(e){var r=t.isFunction(e.url)?e.url():e.url,a=e.type?e.type.toUpperCase():"GET";var n=t("<form>",{method:a==="GET"?"GET":"POST",action:r,style:"display:none"});if(a!=="GET"&&a!=="POST"){n.append(t("<input>",{type:"hidden",name:"_method",value:a.toLowerCase()}))}var i=e.data;if(typeof i==="string"){t.each(i.split("&"),function(e,r){var a=r.split("=");n.append(t("<input>",{type:"hidden",name:a[0],value:a[1]}))})}else if(t.isArray(i)){t.each(i,function(e,r){n.append(t("<input>",{type:"hidden",name:r.name,value:r.value}))})}else if(typeof i==="object"){var o;for(o in i)n.append(t("<input>",{type:"hidden",name:o,value:i[o]}))}t(document.body).append(n);n.submit()}function p(e){if(e&&e.readyState<4){e.onreadystatechange=t.noop;e.abort()}}function d(){return(new Date).getTime()}function h(t){var e=t.clone();e.find("script").each(function(){if(!this.src)jQuery._data(this,"globalEval",false)});return[t.selector,e.contents()]}function v(t){t.search=t.search.replace(/([?&])(_pjax|_)=[^&]*/g,"");return t.href.replace(/\?($|#)/,"$1")}function m(t){var e=document.createElement("a");e.href=t;return e}function x(t){return t.href.replace(/#.*/,"")}function g(e,r){if(e&&r)r.container=e;else if(t.isPlainObject(e))r=e;else r={container:e};if(r.container)r.container=j(r.container);return r}function j(e){e=t(e);if(!e.length){throw"no pjax container for "+e.selector}else if(e.selector!==""&&e.context===document){return e}else if(e.attr("id")){return t("#"+e.attr("id"))}else{throw"cant get selector for pjax container!"}}function y(t,e){return t.filter(e).add(t.find(e))}function w(e){return t.parseHTML(e,document,true)}function b(e,r,a){var n={},i=/<html/i.test(e);var o=r.getResponseHeader("X-PJAX-URL");n.url=o?v(m(o)):a.requestUrl;if(i){var s=t(w(e.match(/<head[^>]*>([\s\S.]*)<\/head>/i)[0]));var c=t(w(e.match(/<body[^>]*>([\s\S.]*)<\/body>/i)[0]))}else{var s=c=t(w(e))}if(c.length===0)return n;n.title=y(s,"title").last().text();if(a.fragment){if(a.fragment==="body"){var u=c}else{var u=y(c,a.fragment).first()}if(u.length){n.contents=a.fragment==="body"?u:u.contents();if(!n.title)n.title=u.attr("title")||u.data("title")}}else if(!i){n.contents=c}if(n.contents){n.contents=n.contents.not(function(){return t(this).is("title")});n.contents.find("title").remove();n.scripts=y(n.contents,"script[src]").remove();n.contents=n.contents.not(n.scripts)}if(n.title)n.title=t.trim(n.title);return n}function T(e){if(!e)return;var r=t("script[src]");e.each(function(){var e=this.src;var a=r.filter(function(){return this.src===e});if(a.length)return;var n=document.createElement("script");var i=t(this).attr("type");if(i)n.type=i;n.src=t(this).attr("src");document.head.appendChild(n)})}var E={};var S=[];var P=[];function C(t,e){E[t]=e;P.push(t);D(S,0);D(P,n.defaults.maxCacheLength)}function A(t,e,r){var a,i;E[e]=r;if(t==="forward"){a=P;i=S}else{a=S;i=P}a.push(e);if(e=i.pop())delete E[e];D(a,n.defaults.maxCacheLength)}function D(t,e){while(t.length>e)delete E[t.shift()]}function R(){return t("meta").filter(function(){var e=t(this).attr("http-equiv");return e&&e.toUpperCase()==="X-PJAX-VERSION"}).attr("content")}function U(){t.fn.pjax=e;t.pjax=n;t.pjax.enable=t.noop;t.pjax.disable=X;t.pjax.click=r;t.pjax.submit=a;t.pjax.reload=i;t.pjax.defaults={timeout:650,push:true,replace:false,type:"GET",dataType:"html",scrollTo:0,maxCacheLength:20,version:R};t(window).on("popstate.pjax",l)}function X(){t.fn.pjax=function(){return this};t.pjax=f;t.pjax.enable=U;t.pjax.disable=t.noop;t.pjax.click=t.noop;t.pjax.submit=t.noop;t.pjax.reload=function(){window.location.reload()};t(window).off("popstate.pjax",l)}if(t.inArray("state",t.event.props)<0)t.event.props.push("state");t.support.pjax=window.history&&window.history.pushState&&window.history.replaceState&&!navigator.userAgent.match(/((iPod|iPhone|iPad).+\bOS\s+[1-4]\D|WebApps\/.+CFNetwork)/);t.support.pjax?U():X()})(jQuery);